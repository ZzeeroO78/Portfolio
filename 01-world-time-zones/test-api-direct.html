<!DOCTYPE html>
<html>
<head>
    <title>Direct API Test</title>
    <style>
        body { font-family: Arial; background: #222; color: #fff; padding: 30px; }
        .city { margin: 15px 0; padding: 15px; background: #333; border-radius: 5px; border-left: 4px solid #667eea; }
        .city h3 { margin: 0 0 10px 0; color: #667eea; }
        .temp { font-size: 24px; font-weight: bold; color: #0f0; }
        .loading { color: #ff0; }
        .error { color: #f00; }
        .success { color: #0f0; }
    </style>
</head>
<body>
    <h1>üåç Provjera Temperatura - Direktno sa API-ja</h1>
    <div id="results"></div>
    
    <script>
        async function testAllCities() {
            const cities = [
                { name: 'London', lat: 51.5074, lon: -0.1278 },
                { name: 'New York', lat: 40.7128, lon: -74.0060 },
                { name: 'Tokyo', lat: 35.6762, lon: 139.6503 },
                { name: 'Paris', lat: 48.8566, lon: 2.3522 },
                { name: 'Sydney', lat: -33.8688, lon: 151.2093 },
                { name: 'Dubai', lat: 25.2048, lon: 55.2708 }
            ];
            
            const results = document.getElementById('results');
            
            for (const city of cities) {
                const html = `<div class="city"><h3>${city.name}</h3><div class="loading">‚è≥ Uƒçitavanje...</div></div>`;
                results.innerHTML += html;
            }
            
            for (let i = 0; i < cities.length; i++) {
                const city = cities[i];
                const apiUrl = `https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current=temperature_2m,relative_humidity_2m,weather_code,is_day&timezone=auto`;
                
                try {
                    const controller = new AbortController();
                    const timeout = setTimeout(() => controller.abort(), 5000);
                    
                    const response = await fetch(apiUrl, { signal: controller.signal });
                    clearTimeout(timeout);
                    
                    const data = await response.json();
                    
                    if (data && data.current) {
                        const temp = Math.round(data.current.temperature_2m);
                        const humidity = data.current.relative_humidity_2m;
                        const html = `
                            <div class="city">
                                <h3>${city.name}</h3>
                                <div class="success">‚úÖ API USPJE≈†AN</div>
                                <div class="temp">${temp}¬∞C</div>
                                <div>Vla≈ænost: ${humidity}%</div>
                                <div style="font-size: 11px; color: #aaa; margin-top: 10px;">
                                    Koordinate: ${city.lat}, ${city.lon}
                                </div>
                            </div>
                        `;
                        
                        // Zamijeni loading div
                        const index = document.querySelectorAll('.city').length - cities.length + i;
                        document.querySelectorAll('.city')[index].innerHTML = `<h3>${city.name}</h3><div class="success">‚úÖ API USPJE≈†AN</div><div class="temp">${temp}¬∞C</div><div>Vla≈ænost: ${humidity}%</div><div style="font-size: 11px; color: #aaa; margin-top: 10px;">Koordinate: ${city.lat}, ${city.lon}</div>`;
                    } else {
                        document.querySelectorAll('.city')[i].innerHTML = `<h3>${city.name}</h3><div class="error">‚ùå Nema podataka u odgovoru</div>`;
                    }
                } catch (error) {
                    document.querySelectorAll('.city')[i].innerHTML = `<h3>${city.name}</h3><div class="error">‚ùå Gre≈°ka: ${error.message}</div>`;
                }
            }
        }
        
        testAllCities();
    </script>
</body>
</html>
