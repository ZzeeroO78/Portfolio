<!DOCTYPE html>
<html>
<head>
    <title>Temperature Test</title>
    <style>
        body { font-family: Arial; background: #222; color: #fff; padding: 20px; }
        .test { margin: 20px 0; padding: 10px; background: #333; border-radius: 5px; }
        .pass { color: #0f0; }
        .fail { color: #f00; }
        code { background: #111; padding: 5px; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>üåç Temperature API Test</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        async function test() {
            // Test 1: Check cityCoordinates
            const cityCoordinates = {
                'london': { lat: 51.5074, lon: -0.1278 },
                'new york': { lat: 40.7128, lon: -74.0060 },
                'tokyo': { lat: 35.6762, lon: 139.6503 },
                'paris': { lat: 48.8566, lon: 2.3522 },
                'sydney': { lat: -33.8688, lon: 151.2093 },
                'dubai': { lat: 25.2048, lon: 55.2708 }
            };
            
            const defaultCities = [
                { name: 'London', timezone: 'Europe/London' },
                { name: 'New York', timezone: 'America/New_York' },
                { name: 'Tokyo', timezone: 'Asia/Tokyo' },
                { name: 'Paris', timezone: 'Europe/Paris' },
                { name: 'Sydney', timezone: 'Australia/Sydney' },
                { name: 'Dubai', timezone: 'Asia/Dubai' }
            ];
            
            results.innerHTML = '<h2>Testing Temperature Updates...</h2>';
            
            // Test each city
            for (const city of defaultCities) {
                const coords = cityCoordinates[city.name.toLowerCase()];
                
                if (!coords) {
                    results.innerHTML += `<div class="test fail">‚ùå ${city.name}: NO COORDINATES FOUND</div>`;
                    continue;
                }
                
                try {
                    const apiUrl = `https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current=temperature_2m,relative_humidity_2m,weather_code,is_day&timezone=auto`;
                    
                    const controller = new AbortController();
                    const timeout = setTimeout(() => controller.abort(), 8000);
                    
                    const response = await fetch(apiUrl, { signal: controller.signal });
                    clearTimeout(timeout);
                    
                    if (!response.ok) {
                        results.innerHTML += `<div class="test fail">‚ùå ${city.name}: HTTP ${response.status}</div>`;
                        continue;
                    }
                    
                    const data = await response.json();
                    
                    if (data && data.current) {
                        const temp = Math.round(data.current.temperature_2m);
                        const humidity = data.current.relative_humidity_2m;
                        results.innerHTML += `<div class="test pass">
                            ‚úÖ <strong>${city.name}</strong>: 
                            <code>${temp}¬∞C</code>, 
                            Humidity: <code>${humidity}%</code>
                        </div>`;
                    } else {
                        results.innerHTML += `<div class="test fail">‚ùå ${city.name}: NO DATA in response</div>`;
                    }
                } catch (error) {
                    results.innerHTML += `<div class="test fail">‚ùå ${city.name}: ${error.message}</div>`;
                }
            }
            
            results.innerHTML += '<h3>‚úÖ Temperature test complete! All cities should show real temperatures above.</h3>';
        }
        
        test();
    </script>
</body>
</html>
